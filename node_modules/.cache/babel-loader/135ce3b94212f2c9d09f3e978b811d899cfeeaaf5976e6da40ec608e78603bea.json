{"ast":null,"code":"import{useEffect,useState}from\"react\";import{db}from\"../config/firebase-config\";import{query,collection,where,onSnapshot,orderBy}from\"firebase/firestore\";import{useGetUserInfo}from\"./useGetUserInfo\";export const useGetTransaction=()=>{// const [transactions, setTransactions] = useState([]);\nconst[transactions,setTransactions]=useState([]);const transactionCollectionRef=collection(db,\"transactions\");const[transactionToals,setTransactionTotals]=useState({balance:0.0,income:0.0,expense:0.0});const{userID}=useGetUserInfo(\"auth\");const getTransactions=async()=>{let unsubscribe;try{const queryTransactions=query(transactionCollectionRef,where(\"userID\",\"==\",userID,orderBy(\"createAt\")));unsubscribe=onSnapshot(queryTransactions,snapshot=>{let docs=[];let totalExpense=0;let totalIncome=0;snapshot.forEach(doc=>{const data=doc.data();const id=doc.id;docs.push({...data,id});if(data.transactionType===\"expense\"){totalExpense+=Number(data.transactionAmount);}else{totalIncome+=Number(data.transactionAmount);}});setTransactions(docs);let balance=totalIncome-totalExpense;setTransactionTotals({balance,income:totalIncome,expense:totalExpense});});}catch(err){console.log(err);}return()=>unsubscribe();};useEffect(()=>{getTransactions();},[]);return{transactions,transactionToals};};","map":{"version":3,"names":["useEffect","useState","db","query","collection","where","onSnapshot","orderBy","useGetUserInfo","useGetTransaction","transactions","setTransactions","transactionCollectionRef","transactionToals","setTransactionTotals","balance","income","expense","userID","getTransactions","unsubscribe","queryTransactions","snapshot","docs","totalExpense","totalIncome","forEach","doc","data","id","push","transactionType","Number","transactionAmount","err","console","log"],"sources":["/Users/lucylu/Desktop/projects/expense-tracker/src/hooks/useGetTransaction.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { db } from \"../config/firebase-config\";\nimport {\n  query,\n  collection,\n  where,\n  onSnapshot,\n  orderBy,\n} from \"firebase/firestore\";\nimport { useGetUserInfo } from \"./useGetUserInfo\";\n\nexport const useGetTransaction = () => {\n  // const [transactions, setTransactions] = useState([]);\n  const [transactions, setTransactions] = useState([]);\n\n  const transactionCollectionRef = collection(db, \"transactions\");\n  const [transactionToals, setTransactionTotals] = useState({\n    balance: 0.0,\n    income: 0.0,\n    expense: 0.0,\n  });\n  const { userID } = useGetUserInfo(\"auth\");\n\n  const getTransactions = async () => {\n    let unsubscribe;\n    try {\n      const queryTransactions = query(\n        transactionCollectionRef,\n        where(\"userID\", \"==\", userID, orderBy(\"createAt\"))\n      );\n\n      unsubscribe = onSnapshot(queryTransactions, (snapshot) => {\n        let docs = [];\n        let totalExpense = 0;\n        let totalIncome = 0;\n\n        snapshot.forEach((doc) => {\n          const data = doc.data();\n\n          const id = doc.id;\n\n          docs.push({ ...data, id });\n\n          if (data.transactionType === \"expense\") {\n            totalExpense += Number(data.transactionAmount);\n          } else {\n            totalIncome += Number(data.transactionAmount);\n          }\n        });\n\n        setTransactions(docs);\n\n        let balance = totalIncome - totalExpense;\n\n        setTransactionTotals({\n          balance,\n          income: totalIncome,\n          expense: totalExpense,\n        });\n      });\n    } catch (err) {\n      console.log(err);\n    }\n\n    return () => unsubscribe();\n  };\n\n  useEffect(() => {\n    getTransactions();\n  }, []);\n\n  return { transactions, transactionToals };\n};\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,EAAE,KAAQ,2BAA2B,CAC9C,OACEC,KAAK,CACLC,UAAU,CACVC,KAAK,CACLC,UAAU,CACVC,OAAO,KACF,oBAAoB,CAC3B,OAASC,cAAc,KAAQ,kBAAkB,CAEjD,MAAO,MAAM,CAAAC,iBAAiB,CAAGA,CAAA,GAAM,CACrC;AACA,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CAEpD,KAAM,CAAAW,wBAAwB,CAAGR,UAAU,CAACF,EAAE,CAAE,cAAc,CAAC,CAC/D,KAAM,CAACW,gBAAgB,CAAEC,oBAAoB,CAAC,CAAGb,QAAQ,CAAC,CACxDc,OAAO,CAAE,GAAG,CACZC,MAAM,CAAE,GAAG,CACXC,OAAO,CAAE,GACX,CAAC,CAAC,CACF,KAAM,CAAEC,MAAO,CAAC,CAAGV,cAAc,CAAC,MAAM,CAAC,CAEzC,KAAM,CAAAW,eAAe,CAAG,KAAAA,CAAA,GAAY,CAClC,GAAI,CAAAC,WAAW,CACf,GAAI,CACF,KAAM,CAAAC,iBAAiB,CAAGlB,KAAK,CAC7BS,wBAAwB,CACxBP,KAAK,CAAC,QAAQ,CAAE,IAAI,CAAEa,MAAM,CAAEX,OAAO,CAAC,UAAU,CAAC,CACnD,CAAC,CAEDa,WAAW,CAAGd,UAAU,CAACe,iBAAiB,CAAGC,QAAQ,EAAK,CACxD,GAAI,CAAAC,IAAI,CAAG,EAAE,CACb,GAAI,CAAAC,YAAY,CAAG,CAAC,CACpB,GAAI,CAAAC,WAAW,CAAG,CAAC,CAEnBH,QAAQ,CAACI,OAAO,CAAEC,GAAG,EAAK,CACxB,KAAM,CAAAC,IAAI,CAAGD,GAAG,CAACC,IAAI,CAAC,CAAC,CAEvB,KAAM,CAAAC,EAAE,CAAGF,GAAG,CAACE,EAAE,CAEjBN,IAAI,CAACO,IAAI,CAAC,CAAE,GAAGF,IAAI,CAAEC,EAAG,CAAC,CAAC,CAE1B,GAAID,IAAI,CAACG,eAAe,GAAK,SAAS,CAAE,CACtCP,YAAY,EAAIQ,MAAM,CAACJ,IAAI,CAACK,iBAAiB,CAAC,CAChD,CAAC,IAAM,CACLR,WAAW,EAAIO,MAAM,CAACJ,IAAI,CAACK,iBAAiB,CAAC,CAC/C,CACF,CAAC,CAAC,CAEFtB,eAAe,CAACY,IAAI,CAAC,CAErB,GAAI,CAAAR,OAAO,CAAGU,WAAW,CAAGD,YAAY,CAExCV,oBAAoB,CAAC,CACnBC,OAAO,CACPC,MAAM,CAAES,WAAW,CACnBR,OAAO,CAAEO,YACX,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAAE,MAAOU,GAAG,CAAE,CACZC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAClB,CAEA,MAAO,IAAMd,WAAW,CAAC,CAAC,CAC5B,CAAC,CAEDpB,SAAS,CAAC,IAAM,CACdmB,eAAe,CAAC,CAAC,CACnB,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,CAAET,YAAY,CAAEG,gBAAiB,CAAC,CAC3C,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}